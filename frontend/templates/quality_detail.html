{% extends "base.html" %}

{% block title %}Data Quality Check - Watchtower AI{% endblock %}

{% block auth_buttons %}
<div class="user-menu">
    <a href="/project/{{ project_id }}" class="btn btn-outline btn-sm">‚Üê Back to Project</a>
    <button class="btn btn-outline" onclick="handleLogout()">Logout</button>
</div>
{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="/static/css/quality_detail.css">
{% endblock %}

{% block content %}
<section class="quality-detail-page">
    <div class="container">
        <!-- Header -->
        <div class="page-header">
            <h1>Data Quality Check Details</h1>
            <p>Batch #<span id="batch-number">--</span> | Checked: <span id="check-timestamp">--</span></p>
        </div>

        <!-- Overview Cards -->
        <div class="overview-cards">
            <div class="overview-card">
                <div class="card-icon icon-rows">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M3 6h18M3 12h18M3 18h18" />
                    </svg>
                </div>
                <div class="card-content">
                    <h3 id="total-rows">--</h3>
                    <p>Total Rows Checked</p>
                </div>
            </div>

            <div class="overview-card">
                <div class="card-icon icon-columns">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="3" width="7" height="18" />
                        <rect x="14" y="3" width="7" height="18" />
                    </svg>
                </div>
                <div class="card-content">
                    <h3 id="total-columns">--</h3>
                    <p>Total Columns</p>
                </div>
            </div>

            <div class="overview-card">
                <div class="card-icon icon-missing">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10" />
                        <path d="M12 6v6M12 16v2" />
                    </svg>
                </div>
                <div class="card-content">
                    <h3 id="columns-with-missing">--</h3>
                    <p>Columns with Missing Values</p>
                </div>
            </div>

            <div class="overview-card">
                <div class="card-icon icon-duplicates">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="8" y="8" width="12" height="12" rx="2" />
                        <path d="M4 16V6a2 2 0 012-2h10" />
                    </svg>
                </div>
                <div class="card-content">
                    <h3 id="duplicate-percentage">--</h3>
                    <p>Duplicate Row %</p>
                </div>
            </div>
        </div>

        <!-- Duplicate Info Section -->
        <div class="detail-section">
            <h2>Duplicate Rows</h2>
            <div class="duplicate-info">
                <div class="info-item">
                    <span class="info-label">Total Duplicate Rows:</span>
                    <span class="info-value" id="total-duplicates">--</span>
                </div>
                <div class="info-item">
                    <span class="info-label">Duplicate Percentage:</span>
                    <span class="info-value" id="duplicate-percent-detail">--</span>
                </div>
            </div>
        </div>

        <!-- Missing Values Table -->
        <div class="detail-section">
            <h2>Missing Values by Column</h2>
            <p class="section-description">Breakdown of missing values per column in the dataset.</p>

            <div class="table-container">
                <table class="detail-table" id="missing-values-table">
                    <thead>
                        <tr>
                            <th>Column Name</th>
                            <th>Missing Count</th>
                            <th>Missing %</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody id="missing-values-body">
                        <tr>
                            <td colspan="4" class="loading-cell">Loading...</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</section>

<!-- Hidden IDs -->
<input type="hidden" id="project-id" value="{{ project_id }}">
<input type="hidden" id="check-id" value="{{ check_id }}">
{% endblock %}

{% block extra_js %}
<script src="/static/js/quality_detail.js"></script>
{% endblock %}